#!/bin/sh
# {%@rot13 QB ABG RQVG %}

#!/bin/bash

if [ ! -f "../../jamal.sh" ]; then
echo "Error: ../../jamal.sh not found!"
exit 1
fi

chmod 0700 ../../jamal.sh
../../jamal.sh ../../jamal-maven-load/it.sh.jam ../../jamal-maven-load/it.sh
../../jamal.sh integrationtest.jam integrationtest
../../jamal.sh README.adoc.jam README.adoc

{%#for $j in (sh,txt)={%@comment%}\
{%@for $i in (groovy,ruby,py,scriptbasic)=
if [ ! -f "test_$i.$j.jam.jam" ]; then
    echo "Error: test_$i.$j.jam.jam does not exist."
    exit 1
fi
../../jamal.sh -T7 test_$i.$j.jam.jam test_$i.$j.jam %}
%}

docker build -t jamal-test .
if [ $? -ne 0 ]; then
  echo "Docker build failed. Exiting."
  exit 1
fi
docker run -it jamal-test